# - hosts: hetzner_test
#   remote_user: root
#   tasks:
#   - import_role:
#       name: user
#     vars:
#       username: "{{ user.name }}"
#       password: "{{ ansible_become_pass | password_hash('sha512') }}"
#   ignore_errors: yes
#   ignore_unreachable: yes

- name: Generate SSH key
  hosts: localhost
  connection: local
  tasks:
    - import_role:
        name: sshkeygen
      vars:
        sshkeygen_username: "{{ user.name }}"
        sshkeygen_directory: "/Users/kostage/.ssh/ansible_test"

- hosts: hetzner_test
  remote_user: "{{ user.name }}"
  become: yes
  tasks:
    # - import_role:
    #     name: apt
    - import_role:
        name: ssh
      vars:
        username: "{{ user.name }}"
    # - import_role:
    #     name: firewall # also allow non-standard SSH port
